import { useState } from "react";
import { type CityType } from "../data/commun.types";

type Props = {
  cities: CityType[];
};

const riverStyle = {
  fill: "none",
  fillOpacity: 1,
  stroke: "#7fcbec",
  strokeWidth: 6,
  strokeMiterlimit: 4,
  strokeOpacity: 1,
};

const Map = ({ cities }: Props) => {
  const [hovered, setHovered] = useState<number | null>(null);
  return (
    <div
      style={{
        width: "100%",
        aspectRatio: "1423/1897",
        height: "auto",
        position: "relative",
      }}
    >
      <svg
        style={{ width: "100%", height: "100%" }}
        preserveAspectRatio="xMidYMax"
        viewBox="-276 50542 1423 1897"
      >
        <g className="city-paths" transform="translate(355,475)">
          <g transform="matrix(2,0,0,2,-618.74882,-51603.846)">
            {cities.map((c) => {
              const { codeInsee, svgPath } = c;
              return (
                <path
                  key={codeInsee}
                  className="fill-indigo-50 stroke-indigo-600 stroke-1 opacity-80 hover:opacity-100"
                  d={svgPath.d}
                  id={codeInsee.toString()}
                  onMouseEnter={() => setHovered(codeInsee)}
                  onMouseLeave={() => setHovered(null)}
                  transform={svgPath.transform}
                />
              );
            })}
          </g>
        </g>
        <g className="city-labels" transform="translate(-20,0)">
          {cities.map((c) => {
            const { codeInsee, svgLabel } = c;
            return (
              <text
                key={codeInsee}
                id={codeInsee.toString()}
                x={svgLabel.x}
                y={svgLabel.y}
                className={
                  hovered === codeInsee
                    ? "pointer-events-none fill-indigo-600 text-xs"
                    : "pointer-events-none hidden fill-indigo-400 text-xs"
                }
              >
                {svgLabel.titles.map((t, i) => (
                  <tspan key={i} x={t.x} y={t.y}>
                    {t.title}
                  </tspan>
                ))}
              </text>
            );
          })}
        </g>
      </svg>
      <div
        style={{
          width: "25%",
          aspectRatio: "310/350",
          height: "auto",
          position: "absolute",
          top: "10%",
          right: "10%",
        }}
      >
        <svg
          style={{ width: "100%", height: "100%" }}
          preserveAspectRatio="xMidYMax"
          viewBox="0 0 310 350"
        >
          <g id="districts" transform="translate(-217.21023,-248.11122)">
            <path
              className="fill-indigo-50 stroke-indigo-600 stroke-1 opacity-80 hover:opacity-100"
              d="M 333.35674,392.22703 L 332.48174,401.07078 L 329.16924,400.97703 L 327.54424,399.75828 L 323.73174,399.53953 L 322.29424,398.88328 L 322.04424,402.85203 L 320.66924,403.66453 L 317.10674,404.53953 L 315.07549,402.91453 L 309.82549,403.88328 L 310.54424,410.44578 L 311.60674,416.60203 L 312.73174,419.19578 L 315.98174,422.00828 L 309.66924,422.10203 L 303.85674,419.66453 L 298.82549,417.72703 L 295.10674,412.72703 L 292.10674,410.19578 L 287.01299,408.00828 L 262.04424,405.66453 L 257.10674,405.38328 L 256.45049,406.72703 L 255.16924,417.07078 L 253.85674,424.69578 L 245.45049,432.44578 L 246.10674,440.69578 L 241.73174,440.38328 L 233.79424,443.28953 L 224.41924,445.38328 L 223.29424,451.38328 L 226.20049,454.94578 L 234.45049,464.78953 L 238.16924,463.82078 L 250.63799,473.22703 L 280.07549,453.47703 L 286.04424,453.00828 L 293.16924,447.50828 L 312.91924,455.25828 L 311.91924,458.50828 L 312.91924,459.63328 L 314.51299,459.78953 L 316.29424,457.53953 L 320.51299,457.19578 L 323.41924,452.19578 L 333.45049,454.28953 L 336.20049,452.35203 L 341.38799,448.47703 L 344.13799,439.25828 L 347.51299,428.88328 L 351.41924,423.38328 L 357.23174,417.25828 L 358.51299,410.94578 L 358.51299,400.41453 L 355.76299,394.10203 L 353.20049,391.50828 L 345.91924,390.88328 L 333.35674,392.22703 z "
              id="path7362"
            />
            <path
              className="fill-indigo-50 stroke-indigo-600 stroke-1 opacity-80 hover:opacity-100"
              d="M 427.45049,450.25828 L 426.88799,460.35203 L 425.63799,469.38328 L 425.07549,473.85203 L 419.91924,482.53953 L 406.98174,487.22703 L 405.60674,488.82078 L 404.91924,491.57078 L 404.91924,493.97703 L 406.41924,498.10203 L 406.41924,503.47703 L 404.57549,512.72703 L 403.10674,522.10203 L 404.13799,531.94578 L 405.51299,542.91453 L 406.38799,551.03953 L 406.41924,551.03953 L 419.35674,552.97703 L 416.76299,516.72703 L 430.35674,514.13328 L 438.76299,525.13328 L 459.48174,533.88328 L 482.10674,541.63328 L 495.04424,543.25828 L 494.23174,515.10203 L 503.95049,481.47703 L 504.16924,481.13328 C 499.09136,478.4736 494.48174,476.00828 494.48174,476.00828 L 485.35674,472.00828 L 472.20049,472.00828 L 472.07549,469.03953 L 452.98174,461.03953 L 436.16924,453.47703 L 427.45049,450.25828 z "
              id="path3337"
            />
            <path
              className="fill-indigo-50 stroke-indigo-600 stroke-1 opacity-80 hover:opacity-100"
              d="M 423.88799,323.35203 L 412.70049,324.53953 L 403.48174,329.88328 L 383.91924,352.53953 L 383.32549,354.16453 L 381.26299,360.47703 L 380.04424,374.16453 L 380.23174,405.03953 L 449.88799,402.32078 L 448.63799,401.53953 L 448.29424,399.13328 L 439.73174,390.53953 L 439.88799,388.13328 L 436.16924,387.97703 L 429.38799,376.78953 L 424.04424,373.57078 L 423.88799,323.35203 z "
              id="path5302"
            />
            <path
              className="fill-indigo-50 stroke-indigo-600 stroke-1 opacity-80 hover:opacity-100"
              d="M 378.04424,427.88328 L 377.01299,431.07078 L 369.01299,445.35203 L 358.04424,466.07078 L 351.63799,478.53953 L 346.35674,485.28953 L 338.70049,501.50828 L 336.29424,510.22703 L 334.70049,520.16453 L 334.26299,524.97703 L 336.20049,538.07078 L 340.57549,555.38328 L 346.54424,570.10203 L 354.48174,582.25828 L 365.63799,587.41453 L 378.91924,590.97703 L 385.70049,590.50828 L 380.51299,555.57078 L 406.38799,551.03953 L 405.51299,542.91453 L 404.13799,531.94578 L 403.10674,522.10203 L 404.57549,512.72703 L 406.41924,503.47703 L 406.41924,498.10203 L 404.91924,493.97703 L 404.91924,491.57078 L 405.60674,488.82078 L 406.98174,487.22703 L 419.91924,482.53953 L 425.07549,473.85203 L 425.63799,469.38328 L 426.88799,460.35203 L 427.41924,450.57078 L 378.04424,427.88328 z "
              id="path5318"
            />
            <path
              className="fill-indigo-50 stroke-indigo-600 stroke-1 opacity-80 hover:opacity-100"
              d="M 449.88799,402.32078 L 380.23174,405.03953 L 380.23174,406.13328 L 380.57549,417.78953 L 379.98174,421.91453 L 378.04424,427.88328 L 427.41924,450.57078 L 427.45049,450.25828 L 436.16924,453.47703 L 452.98174,461.03953 L 472.07549,469.03953 L 472.20049,472.00828 L 485.35674,472.00828 L 494.48174,476.00828 C 494.48174,476.00828 499.09136,478.4736 504.16924,481.13328 L 509.60674,471.75828 L 514.95049,456.38328 L 519.63799,437.94578 L 507.01299,433.75828 L 483.88799,433.57078 L 465.60674,431.97703 L 466.10674,420.63328 L 460.26299,419.19578 L 461.07549,412.72703 L 454.60674,410.13328 L 449.91924,402.35203 L 449.88799,402.32078 z "
              id="path5304"
            />
            <path
              className="fill-indigo-50 stroke-indigo-600 stroke-1 opacity-80 hover:opacity-100"
              d="M 358.51299,401.97703 L 358.51299,410.94578 L 357.23174,417.25828 L 351.41924,423.38328 L 347.51299,428.88328 L 344.13799,439.25828 L 341.38799,448.47703 L 336.20049,452.35203 L 333.45049,454.28953 L 325.66924,463.82078 L 321.32549,473.53953 L 319.20049,484.85203 L 319.70049,498.78953 L 321.48174,506.85203 L 334.26299,524.97703 L 334.70049,520.16453 L 336.29424,510.22703 L 338.70049,501.50828 L 346.35674,485.28953 L 351.63799,478.53953 L 358.04424,466.07078 L 369.01299,445.35203 L 377.01299,431.07078 L 379.98174,421.91453 L 380.57549,417.78953 L 380.23174,406.13328 L 380.16924,394.91453 L 373.73174,396.38328 L 373.41924,399.94578 L 367.41924,401.72703 L 362.23174,401.53953 L 358.51299,401.97703 z "
              id="path7368"
            />
            <path
              className="fill-indigo-50 stroke-indigo-600 stroke-1 opacity-80 hover:opacity-100"
              d="M 358.51299,401.97703 L 362.23174,401.53953 L 367.41924,401.72703 L 373.41924,399.94578 L 373.73174,396.38328 L 380.16924,394.91453 L 380.04424,374.16453 L 380.23174,372.22703 L 370.98174,366.44578 L 360.79424,368.72703 L 343.63799,370.82078 L 336.51299,374.85203 C 336.51299,374.85203 329.56632,377.44577 328.91924,377.44578 C 328.45033,377.44578 321.64869,380.26209 317.07549,382.13328 L 319.70049,387.97703 L 322.76299,391.35203 L 329.41924,392.66453 L 345.91924,390.88328 L 353.20049,391.50828 L 355.76299,394.10203 L 358.51299,400.41453 L 358.51299,401.97703 z "
              id="path7365"
            />
            <path
              className="fill-indigo-50 stroke-indigo-600 stroke-1 opacity-80 hover:opacity-100"
              d="M 317.07549,382.13328 C 321.64869,380.26209 328.45033,377.44578 328.91924,377.44578 C 329.56632,377.44577 336.51299,374.85203 336.51299,374.85203 L 343.63799,370.82078 L 360.79424,368.72703 L 370.98174,366.44578 L 380.23174,372.22703 L 381.26299,360.47703 L 383.32549,354.16453 L 383.91924,352.53953 L 373.23174,341.69578 L 367.41924,345.41453 L 363.04424,344.44578 L 357.23174,344.60203 L 357.54424,342.82078 L 357.38799,340.88328 L 355.60674,339.91453 L 354.32549,341.38328 L 353.66924,342.66453 L 352.04424,342.19578 L 338.95049,336.85203 L 338.13799,332.78953 L 337.01299,329.72703 L 334.10674,327.63328 L 335.88799,325.19578 L 329.07549,319.85203 L 326.01299,323.72703 L 321.32549,329.88328 L 314.66924,340.72703 L 309.35674,351.41453 L 307.57549,358.35203 L 307.57549,365.63328 L 309.82549,370.82078 L 314.35674,375.00828 L 316.79424,381.50828 L 317.07549,382.13328 z "
              id="path7359"
            />
            <path
              className="fill-indigo-50 stroke-indigo-600 stroke-1 opacity-80 hover:opacity-100"
              d="M 368.70049,256.94578 L 363.38799,267.28953 L 357.70049,261.47703 L 346.70049,268.41453 L 337.01299,268.25828 L 339.45049,276.00828 L 337.98174,277.16453 L 332.79424,277.63328 L 329.73174,285.88328 L 326.32549,286.22703 L 326.98174,289.44578 L 322.91924,289.60203 L 322.29424,295.10203 L 319.20049,302.07078 L 311.29424,309.19578 L 305.95049,313.72703 L 303.35674,322.28953 L 288.95049,312.10203 L 287.82549,314.85203 L 277.16924,313.88328 L 278.13799,317.91453 L 272.63799,322.60203 L 262.60674,316.94578 L 258.23174,320.82078 L 247.23174,327.94578 L 251.10674,328.75828 L 252.07549,332.97703 L 261.13799,331.35203 L 267.60674,330.69578 L 266.63799,337.00828 L 265.66924,344.94578 L 267.13799,353.00828 L 267.91924,355.94578 L 273.76299,361.25828 L 274.07549,368.22703 L 269.38799,371.47703 L 269.70049,375.00828 L 270.85674,375.50828 L 270.66924,378.25828 L 266.32549,381.16453 L 267.13799,390.88328 L 257.73174,404.13328 L 257.10674,405.38328 L 262.04424,405.66453 L 287.01299,408.00828 L 292.10674,410.19578 L 295.10674,412.72703 L 298.82549,417.72703 L 303.85674,419.66453 L 309.66924,422.10203 L 315.98174,422.00828 L 312.73174,419.19578 L 311.60674,416.60203 L 310.54424,410.44578 L 309.82549,403.88328 L 315.07549,402.91453 L 317.10674,404.53953 L 320.66924,403.66453 L 322.04424,402.85203 L 322.29424,398.88328 L 323.73174,399.53953 L 327.54424,399.75828 L 329.16924,400.97703 L 332.48174,401.07078 L 333.35674,392.22703 L 329.41924,392.66453 L 322.76299,391.35203 L 319.70049,387.97703 L 316.79424,381.50828 L 314.35674,375.00828 L 309.82549,370.82078 L 307.57549,365.63328 L 307.57549,358.35203 L 309.35674,351.41453 L 314.66924,340.72703 L 321.32549,329.88328 L 326.01299,323.72703 L 329.07549,319.85203 L 338.95049,308.03953 L 346.70049,301.72703 L 356.41924,295.25828 L 364.35674,292.19578 L 370.16924,288.47703 L 376.48174,281.50828 L 379.23174,275.38328 L 379.88799,270.69578 L 375.51299,270.19578 L 372.91924,268.57078 L 368.70049,256.94578 z "
              id="path7332"
            />
          </g>
          <g id="river" transform="translate(-217.21023,-248.11122)">
            <path
              style={riverStyle}
              d="M 385.7007,590.49748 C 378.35617,591.92033 371.27308,588.94118 364.36763,586.83309 C 359.53119,584.33404 353.49658,583.22008 351.40743,577.54513 C 343.49785,566.62054 339.79901,553.39894 336.78832,540.41719 C 334.67648,533.48226 336.23691,525.27072 330.61633,519.81785 C 326.60187,513.41951 320.4116,507.98094 319.97031,500.00647 C 318.73967,488.96207 318.80679,477.17523 324.19822,467.1367 C 326.63109,461.73386 330.83719,457.01104 335.17043,453.0742 C 338.63852,450.64467 342.59526,448.49598 342.78094,443.75556 C 345.31991,435.35523 347.28464,426.28176 354.30308,420.33306 C 360.19393,415.57865 358.09188,407.07871 358.5237,400.42015 C 356.84327,396.09538 354.78888,390.09104 348.98933,391.14992 C 340.1433,390.03234 330.63598,394.85275 322.30195,390.84053 C 316.18656,385.56443 317.24314,375.6703 310.24514,371.20067 C 304.8204,363.31108 308.13239,352.80438 312.48612,345.12473 C 319.3528,330.96843 329.5336,318.71377 340.0396,307.1652 C 347.51757,300.81853 355.5883,294.95676 364.93899,291.8194 C 372.59659,287.47043 379.47891,279.8771 379.87706,270.68229"
              id="path6328"
            />
            <path
              style={riverStyle}
              d="M 423.87795,322.77156 C 417.83846,323.7115 411.57335,324.01654 406.63984,328.06875 C 400.0935,331.80582 396.41222,339.00418 391.09945,344.23152 C 387.03906,348.80404 382.53505,353.16136 381.56929,359.49323 C 378.95822,376.73969 380.42357,394.33326 380.38816,411.73474 C 382.16188,425.46205 373.39764,436.97492 367.36821,448.45647 C 361.50183,458.92413 356.52974,469.95827 350.33116,480.18856 C 344.63912,486.69282 341.82507,495.11118 338.3265,502.87277 C 335.47697,512.94595 333.01249,523.61729 335.59609,534.01012 C 337.88982,547.08389 341.42996,560.14095 347.70491,571.87804 C 351.26813,576.57701 353.17786,583.18744 359.57497,584.61041 C 366.01841,587.87957 373.2366,589.91153 380.30708,590.88273 C 382.10495,590.75431 383.90283,590.62589 385.7007,590.49748"
              id="river"
            />
          </g>
          <g id="districts-labels" transform="translate(-217.21023,-248.11122)">
            <text
              className="text-xs text-blue-400"
              x="292.05966"
              y="379.91226"
              id="text2176"
            >
              <tspan id="tspan2178" x="292.05966" y="379.91226">
                9
              </tspan>
            </text>
            <text
              className="text-xs text-blue-400"
              x="338.8468"
              y="364.76288"
              id="text2180"
            >
              <tspan id="tspan2182" x="338.8468" y="364.76288">
                4
              </tspan>
            </text>
            <text
              className="text-xs text-blue-400"
              x="364.01199"
              y="391.75824"
              id="text2184"
            >
              <tspan id="tspan2186" x="364.01199" y="391.75824">
                1
              </tspan>
            </text>
            <text
              className="text-xs text-blue-400"
              x="353.03082"
              y="458.10281"
              id="text2188"
            >
              <tspan id="tspan2190" x="353.03082" y="458.10281">
                2
              </tspan>
            </text>
            <text
              className="text-xs text-blue-400"
              x="302.70047"
              y="442.08862"
              id="text2192"
            >
              <tspan id="tspan2194" x="302.70047" y="442.08862">
                5
              </tspan>
            </text>
            <text
              className="text-xs text-blue-400"
              x="372.70541"
              y="519.41437"
              id="text2196"
            >
              <tspan id="tspan2198" x="372.70541" y="519.41437">
                7
              </tspan>
            </text>
            <text
              className="text-xs text-blue-400"
              x="457.35196"
              y="504.31525"
              id="text2200"
            >
              <tspan id="tspan2202" x="457.35196" y="504.31525">
                8
              </tspan>
            </text>
            <text
              className="text-xs text-blue-400"
              x="444.54059"
              y="438.88577"
              id="text2204"
            >
              <tspan id="tspan2206" x="444.54059" y="438.88577">
                3
              </tspan>
            </text>
            <text
              className="text-xs text-blue-400"
              x="408.85178"
              y="376.2016"
              id="text2208"
            >
              <tspan id="tspan2210" x="408.85178" y="376.2016">
                6
              </tspan>
            </text>
          </g>
        </svg>
      </div>
    </div>
  );
};
export default Map;
